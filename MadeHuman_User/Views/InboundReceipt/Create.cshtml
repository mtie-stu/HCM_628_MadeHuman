@model Madehuman_Share.ViewModel.Inbound.InboundReceipt.CreateInboundReceiptViewModel

@{
    ViewData["Title"] = "Tạo phiếu nhập kho";
}

<h2 class="mb-4">Tạo phiếu nhập kho</h2>

<form asp-action="Create" method="post">
    <div class="mb-3">
        <label asp-for="CreateAt" class="form-label">Ngày tạo</label>
        <input asp-for="CreateAt" class="form-control" readonly />
    </div>

    <div class="mb-3">
        <label asp-for="ReceivedAt" class="form-label">Ngày nhận</label>
        <input asp-for="ReceivedAt" class="form-control" type="date" />
    </div>

    <hr />
    <h5>Danh sách sản phẩm nhập</h5>

    <div id="items-container">
        @for (int i = 0; i < Model.Items.Count; i++)
        {
            <div class="row mb-2 align-items-end item-row">
                <div class="col-md-6">
                    <label class="form-label">ProductSKUId</label>
                    <input asp-for="Items[@i].ProductSKUId" class="form-control" />
                </div>
                <div class="col-md-4">
                    <label class="form-label">Số lượng</label>
                    <input asp-for="Items[@i].Quantity" class="form-control" type="number" />
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-danger btn-sm remove-item">X</button>
                </div>
            </div>
        }
    </div>

    <button type="button" id="add-item" class="btn btn-secondary mb-3">+ Thêm dòng</button>

    <div class="mt-3">
        <button type="submit" class="btn btn-primary">Tạo phiếu nhập</button>
        <a asp-action="Index" class="btn btn-secondary">Hủy</a>
    </div>
</form>

@section Scripts {
    <script>
        document.getElementById('add-item').addEventListener('click', function () {
            const container = document.getElementById('items-container');
            const index = container.querySelectorAll('.item-row').length;

            const row = document.createElement('div');
            row.className = 'row mb-2 align-items-end item-row';
            row.innerHTML = `
                <div class="col-md-6">
                    <label class="form-label">ProductSKUId</label>
                    <input name="Items[${index}].ProductSKUId" class="form-control" />
                </div>
                <div class="col-md-4">
                    <label class="form-label">Số lượng</label>
                    <input name="Items[${index}].Quantity" type="number" class="form-control" />
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-danger btn-sm remove-item">X</button>
                </div>
            `;
            container.appendChild(row);
        });

        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('remove-item')) {
                e.target.closest('.item-row').remove();
            }
        });
    </script>
}
