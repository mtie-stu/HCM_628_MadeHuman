@{
    ViewData["Title"] = "Gán nhiệm vụ PackTask";
}

<div class="container mt-4">
    <h3 class="text-primary">📦 Gán & Hoàn thành nhiệm vụ PackTask</h3>

    @if (TempData["Logs"] != null)
    {
        <div class="alert alert-info">
            @Html.Raw(TempData["Logs"]) <!-- ✅ hiển thị log bằng TempData -->
        </div>
    }

    <div class="card shadow-sm mt-3">
        <div class="card-body">
            <form asp-action="Assign" method="post" onsubmit="return validateAndPlaySound();">
                <label for="outboundTaskItemId" class="form-label">🔍 Mã OutboundTaskItem:</label>
                <input type="text" id="outboundTaskItemId" name="outboundTaskItemId" class="form-control" placeholder="Nhập hoặc quét mã..." required />

                <button type="submit" class="btn btn-success mt-3 w-100">
                    🚀 Gán và hoàn thành
                </button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const successSFX = new Audio("/sounds/success.mp3");
        const errorSFX = new Audio("/sounds/error.mp3");

        // Hàm kiểm tra trước khi submit
        function validateAndPlaySound() {
            const input = document.getElementById("outboundTaskItemId").value.trim();
            if (!input) {
                errorSFX.play();
                alert("⚠️ Vui lòng nhập mã OutboundTaskItemId.");
                return false; // chặn submit
            }

            successSFX.play(); // phát âm thanh khi hợp lệ
            return true; // cho phép submit
        }
    </script>
}
