@model Madehuman_Share.ViewModel.WareHouse.WarehouseLocationViewModel
@{
    ViewData["Title"] = "Warehouse Location Details";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
<link rel="stylesheet" href="~/css/pages/Warehouse/warehouse-index.css" asp-append-version="true" />

<div class="warehouse-page">
    <div class="container mt-4">

        <!-- Header -->
        <div class="page-head">
            <div>
                <h2 class="page-title">
                    <i class="bi bi-geo-alt-fill"></i> Chi tiết vị trí kho
                </h2>
                <div class="page-subtext">Xem thông tin location và thao tác nhanh.</div>
            </div>

            <div class="toolbar">
                <a asp-action="All" class="btn btn-outline btn--ripple">
                    <i class="bi bi-list-ul me-1"></i> Danh sách
                </a>
@*                 <a asp-controller="warehouse" asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-orange btn--ripple">
                    <i class="bi bi-pencil-square me-1"></i> Sửa
                </a> *@
            </div>
        </div>

        <!-- Summary card -->
        <div class="card shadow-sm border-0 mb-3">
            <div class="card-body">
                <div class="d-flex flex-wrap align-items-center gap-3">
                    <div>
                        <div class="text-muted small">Tên vị trí</div>
                        <div class="fs-5 fw-semibold">@Model.NameLocation</div>
                    </div>

                    <div class="vr d-none d-md-block"></div>

                    <div>
                        <div class="text-muted small">Zone</div>
                        <span class="status-chip weak">
                            <i class="bi bi-box-seam me-1"></i>
                            <span class="id-chip" title="Bấm để copy">@Model.ZoneId</span>
                        </span>
                    </div>

                    <div class="vr d-none d-md-block"></div>

                    <div>
                        <div class="text-muted small">Location ID</div>
                        <span class="id-chip" title="Bấm để copy">@Model.Id</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Details table (mở rộng sau nếu có thêm fields) -->
        <div class="card shadow-sm border-0">
            <div class="card-body">
                <h6 class="mb-3 text-secondary"><i class="bi bi-info-circle"></i> Thông tin</h6>
                <div class="table-responsive">
                    <table class="table table-striped align-middle mb-0">
                        <tbody>
                            <tr>
                                <th style="width:240px;">Tên vị trí</th>
                                <td>@Model.NameLocation</td>
                            </tr>
                            <tr>
                                <th>ZoneId</th>
                                <td><span class="id-chip" title="Bấm để copy">@Model.ZoneId</span></td>
                            </tr>
                            <tr>
                                <th>Id</th>
                                <td><span class="id-chip" title="Bấm để copy">@Model.Id</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-3 d-flex gap-2">
@*                     <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-orange">
                        <i class="bi bi-pencil-square me-1"></i> Sửa
                    </a> *@
                    <a asp-action="All" class="btn btn-outline">
                        <i class="bi bi-arrow-left me-1"></i> Quay lại danh sách
                    </a>
                </div>
            </div>
        </div>

        <div id="inlineAlert" class="inline-alert d-none"></div>
    </div>
</div>

@section Scripts {
    <script>
        (function(){
          const toast = document.getElementById('inlineAlert');

          function showToast(type, text){
            if (!toast) return;
            toast.className = 'inline-alert ' + (type==='success'?'success':'error');
            toast.textContent = text;
            toast.classList.remove('d-none');
            requestAnimationFrame(()=> toast.classList.add('show'));
            setTimeout(()=>{ toast.classList.remove('show'); setTimeout(()=> toast.classList.add('d-none'), 160); }, 1800);
          }

          // Rút gọn + copy cho .id-chip (giống các trang bạn đã dùng)
          function shortenId(str){
            if (!str) return str;
            const s = String(str).trim();
            if (s.length >= 32) return s.slice(0,8) + '...' + s.slice(-8); // ưu tiên GUID 8...8
            if (s.length > 8)  return s.slice(0,4) + '...' + s.slice(-4);  // chuỗi dài khác
            return s;
          }
          function enhanceIdChips(root=document){
            root.querySelectorAll('.id-chip').forEach(chip=>{
              const full = (chip.getAttribute('data-guid') || chip.textContent || '').trim();
              if (!full || full === '—') return;
              chip.setAttribute('data-guid', full);
              chip.textContent = shortenId(full);
              chip.title = chip.title || 'Bấm để copy';
              chip.classList.add('copy-guid');
              chip.style.cursor = 'pointer';
            });
          }
          document.addEventListener('click', function(e){
            const el = e.target.closest('.copy-guid');
            if (!el) return;
            e.preventDefault(); e.stopPropagation();
            const full = el.getAttribute('data-guid'); if (!full) return;

            if (navigator.clipboard?.writeText) {
              navigator.clipboard.writeText(full)
                .then(()=> showToast('success','✅ Đã copy đầy đủ mã'))
                .catch(()=> showToast('error','❌ Không thể copy.'));
            } else {
              const ta = document.createElement('textarea');
              ta.value = full; ta.style.position='fixed'; ta.style.opacity='0';
              document.body.appendChild(ta); ta.select();
              try { document.execCommand('copy'); showToast('success','✅ Đã copy đầy đủ mã'); }
              catch { showToast('error','❌ Không thể copy.'); }
              finally { document.body.removeChild(ta); }
            }
          });

          enhanceIdChips();
        })();
    </script>
}
